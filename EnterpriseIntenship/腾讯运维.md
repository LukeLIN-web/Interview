# 腾讯业务运维

我投递的是官网叫技术运营, 不用笔试直接面试

#### 为啥想来，

因为做了存储， 想进行存储和系统的工作。

#### 互联网行业了解现状：

新世纪以来技术周期一直在上行，新技术一直在不断改造既有商业模式；供应链成本的下降和供应链效率的提升。

做服务， 有吸引力， 在各自的领域成为了公共基础设施，并以基础设施为根基，发展出了完整的生态。 文化娱乐，你做营销就离不开微信小程序，和微信支付



面试叫 业务运营,  可以问问 sre是啥，技术运营和业务运营一样吗？你们用什么语言？  

#### 为啥有timewait

 如果请求断开报文没到达，服务器会重发， 客户端在2MSL时间段内收到这个重传的报文，给出回应报文，并且重启2MSL计时器。 另一个是客户端发送完最后一个确认报文后，在这个2MSL时间中，就可以使本连接持续的时间内所产生的所有报文段都从网络中消失。这样新的连接中不会出现旧连接的请求报文.

#### 1千万个图片快速存取

在服务器上建立两级索引机制，由服务器接收来自于客户端的请求；所述索引机制的第一层为哈希桶，第二层为红黑树。

#### 写脚本

```shell
cat /etc/passwd | cut -d“：” - f1    #选出：之前的

paste -d \\t f1.txt f2.txt  # 把f1和f2 按列合并， 用\t分割 显示合并后的文件内容。 cat是按行合并

提取前三行  head -3  filename >a.txt
或者 sed -n '1,3p'
cut -f 1，2,3 student.txt 提取前三列
cut -d '!' -f 3 b.txt  指定！为分隔符 delimter
cut -f 1-4 a.txt  提取前四列 f是field ,但是他不能识别很多空格, awk可以识别很多空格和制表符混合.AWK是一种优良的文本处理工具。它不仅是Linux中也是任何环境中现有的功能最强大的数据处理引擎之一。
cat nowcoder.txt | awk NF  去除空行
sort -r 逆序reverse order输出
cut -c 1，3  第一个和第三个character
cut -c 1-12
awk  '{print $4}'| awk -F “：” '{print $2}'  #以空格为分隔符打印第四列,然后,  以：为分隔符, 打印第二列.
sed -n 1p pingsort_1.txt  #打印第一行sed 是 stream editor 的缩写，中文称之为流编辑器。 sed 命令是一个面向行处理的工具，它以行为处理单位，针对每一行进行处理，
grep -o stream hello.cpp | wc -l # 一个是only ,一个是line.shell实现：计算某一文件里”stream”出现的次数

```



#### 机房： 

电，网络， 防水防雷防火， 气地水土生 ，电费， 空间， 消防， 建筑， 设备， 监控设备



#### 运行一个服务需要监视什么?

https://blog.csdn.net/heyongluoyao8/article/details/51413668 非常详细全面

指标:

cpu, memory, disk磁盘空间, 磁盘io, 网络io , 文件handler, 连接数.

##### vmstat 2 

2秒采集一次, 

看cpu情况，中断次数， cs次数， 磁盘io情况 

r：表示运行队列(就是说多少个进程真的分配到CPU)，当这个值超过了CPU数目，就会出现CPU瓶颈了。这个也和top的负载有关系，一般负载超过了3就比较高，超过了5就高，超过了10就不正常了，服务器的状态很危险。top的负载类似每秒的运行队列。如果运行队列过大，表示你的CPU很繁忙，一般会造成CPU使用率很高。
b： block表示阻塞的进程，如在等待I/O请求。

in：每秒CPU的中断interrupt次数，包括时间中断。

cs： context switch每秒上下文切换次数，例如我们调用系统函数，就要进行上下文切换，线程的切换，也要进程上下文切换，这个值要越小越好，太大了，要考虑调低线程或者进程的数目

us：user用户CPU时间占比(%)，例如在做高运算的任务时，如加密解密，那么会导致us很大，这样，r也会变大，造成系统瓶颈。
sy：system系统CPU时间占比(%)，如果太高，表示系统调用时间长，如IO频繁操作。
id ：空闲 CPU时间占比(%)，一般来说，id + us + sy = 100,一般认为id是空闲CPU使用率，us是用户CPU使用率，sy是系统CPU使用率。
wt： wait等待IO的CPU时间。

swpd：虚拟内存已使用的大小，如果大于0，表示你的机器物理内存不足了，如果不是程序内存泄露的原因，那么你该升级内存了或者把耗内存的任务迁移到其他机器，单位为KB。
free ：空闲的物理内存的大小，我的机器内存总共8G，剩余4457612KB，单位为KB。
buff：Linux/Unix系统来存储目录里面有什么内容，权限等的缓存，这里大概占用280M，单位为KB。
cache：cache直接用来记忆我们打开的文件，给文件做缓冲，这里大概占用280M(这里是Linux/Unix的聪明之处，把空闲的物理内存的一部分拿来做文件、目录和进程地址空间的缓存，是为了提高程序执行的性能，当程序使用内存时，buffer/cached会很快地被使用)，单位为KB。
si： 每秒从磁盘读入虚拟内存的大小，如果这个值大于0，表示物理内存不够用或者内存泄露了，要查找耗内存进程解决掉。本机内存充裕，一切正常，单位为KB。
so：每秒虚拟内存写入磁盘的大小，如果这个值大于0，同上，单位为KB。

##### top

看cpu占比

us：用户空间占用CPU的百分比
sy：内核空间占用CPU的百分比
ni：改变过优先级的进程占用CPU的百分比
id： 空闲CPU百分比
wa： IO等待占用CPU的百分比
hi：硬中断（Hardware IRQ）占用CPU的百分比
si：软中断（Software Interrupts）占用CPU的百分比

从top的结果看CPU负载情况，主要看us和sy，其中us<=70，sy<=35，us+sy<=70说明状态良好，同时可以结合idle值来看，如果id<=70 则表示IO的压力较大。也可以和uptime一样，看第一行。

##### uptime

可以看平均负载

17:53:46为当前时间up 158 days, 6:23机器运行时间，时间越大说明你的机器越稳定
2 users用户连接数，而不是总用户数
load average: 0.00, 0.00, 0.00 最近1分钟，5分钟，15分钟的系统平均负载。
将平均负载值除以核数，如果结果不大于3，那么系统性能较好，如果不大于4那么系统性能可以接受，如果大于5，那么系统性能较差。

##### free

可以看内存使用情况。 

##### df

看磁盘disk情况

##### netstat 

看网络情况

lsof 看文件句柄  

select   =='name' order=='decent' 

